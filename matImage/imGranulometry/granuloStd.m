function gstd = granuloStd(tab, xi)
% Compute standard deviation of granulometric curve(s).
%
%   GLMS = granuloMeanSize(TAB, XI)
%   Compute grey level mean size from a granulometric curve by using
%   geometric mean.
%   
%   Example
%     % Compute granulometric curve by opening with square structuring
%     % element on rice image 
%     img = imread('rice.png');
%     [gr, diams] = imGranulo(img, 'opening', 'square', 1:20);
%     % display as a function of strel diameter
%     plot(diams, gr);
%     xlabel('Strel diameter (pixel)'); ylabel('Percentage of Variations');
%     glms = granuloMeanSize(gr, diams)
%     glms = 
%         7.7274
%
%   See also
%     imGranulometry, imGranulo, imGranuloByRegion, granuloMeanSize

% ------
% Author: David Legland
% e-mail: david.legland@inrae.fr
% Created: 2017-08-29,    using Matlab 7.9.0.529 (R2009b)
% Copyright 2014 INRAE - Cepia Software Platform.

% extract data
data = tab;

% in case data are provided as Table, extract numerical data
if isa(tab, 'Table')
    data = tab.data;
end

% compute arithmetic mean
gmean = sum(bsxfun(@times, xi, data / 100), 2);

% compute standard deviation
gstd = sqrt(sum(bsxfun(@times, bsxfun(@minus, xi, gmean).^2, data / 100), 2));

